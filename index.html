<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interaktywna Oś Czasu 5 </title>
    <link rel="stylesheet" href="style-kartka.css"> <!-- Link do pliku CSS -->
</head>
<link href="https://fonts.googleapis.com/css2?family=Mea+Culpa&display=swap" rel="stylesheet">

<body>
    <h1>Nasza Oś Czasu</h1>
    <div class="timeline-container">
        <div class="timeline">
            <div class="first-dot"></div> <!-- Kropka na początku osi -->
        </div>
        <div class="timeline-item" data-year="2017" style="top: 3%;">
            <div class="dot"></div>
            <div class="year">2017</div>
            <img class="lazy-image" data-src="https://raw.githubusercontent.com/n4ce1/nasza-os-czasu/main/123.png"
                alt="Zdjęcie 2017">
        </div>
        <div class="timeline-item" data-year="2018" style="top: 10%;">
            <div class="dot"></div>
            <div class="year">2018</div>
            <img class="lazy-image" data-src="https://raw.githubusercontent.com/n4ce1/nasza-os-czasu/main/123.png"
                alt="Zdjęcie 2018">
        </div>
        <div class="timeline-item" data-year="2019" style="top: 20%;">
            <div class="dot"></div>
            <div class="year">2019</div>
            <img class="lazy-image" data-src="https://raw.githubusercontent.com/n4ce1/nasza-os-czasu/main/123.png"
                alt="Zdjęcie 2019">
        </div>
        <div class="timeline-item" data-year="2020" style="top: 30%;">
            <div class="dot"></div>
            <div class="year">2020</div>
            <img class="lazy-image" data-src="https://raw.githubusercontent.com/n4ce1/nasza-os-czasu/main/123.png"
                alt="Zdjęcie 2020">
        </div>
        <div class="timeline-item" data-year="2021" style="top: 40%;">
            <div class="dot"></div>
            <div class="year">2021</div>
            <img class="lazy-image" data-src="https://raw.githubusercontent.com/n4ce1/nasza-os-czasu/main/123.png"
                alt="Zdjęcie 2021">
        </div>
        <div class="timeline-item" data-year="2022" style="top: 50%;">
            <div class="dot"></div>
            <div class="year">2022</div>
            <img class="lazy-image" data-src="https://raw.githubusercontent.com/n4ce1/nasza-os-czasu/main/123.png"
                alt="Zdjęcie 2022">
        </div>
        <div class="timeline-item" data-year="2023" style="top: 60%;">
            <div class="dot"></div>
            <div class="year">2023</div>
            <img class="lazy-image" data-src="https://raw.githubusercontent.com/n4ce1/nasza-os-czasu/main/123.png"
                alt="Zdjęcie 2023">
        </div>
        <div class="timeline-item" data-year="2024" style="top: 70%;">
            <div class="dot"></div>
            <div class="year">2024</div>
            <img class="lazy-image" data-src="https://raw.githubusercontent.com/n4ce1/nasza-os-czasu/main/123.png"
                alt="Zdjęcie 2024">
        </div>
        <div class="timeline-item" data-year="2025" style="top: 80%;">
            <div class="dot"></div>
            <div class="year">2025</div>
            <img class="lazy-image" data-src="https://raw.githubusercontent.com/n4ce1/nasza-os-czasu/main/123.png"
                alt="Zdjęcie 2025">
        </div>
        <div class="timeline-end">
            <div class="arrow-down"></div>
            <div class="infinity-symbol">∞</div>
        </div>
    </div>

    <script>
        let firstInteraction = false;
        let index = 0;
        let isScrolling = false;
        let lastScrollTime = 0; // Nowa zmienna do zapisywania czasu ostatniego przewinięcia
        const items = document.querySelectorAll(".timeline-item");
        const scrollThreshold = 20;
        const scrollDelay = 500; // Czas opóźnienia między przewinięciami (0.5s)
        const yearDelay = 1000; // Opóźnienie między 2017 a 2018 (1s)
        const imageDelay = 1000; // Opóźnienie między datą 2017 a zdjęciem (1s)

        function showItem(index) {
            items.forEach((item, i) => {
                if (i === index) {
                    item.classList.add("active"); // Pokaż datę
                    setTimeout(() => {
                        item.querySelector("img").style.display = "block"; // Pokaż zdjęcie po 500ms
                    }, 500);
                } else {
                    item.classList.remove("active");
                    item.querySelector("img").style.display = "none";
                }
            });

            // Po 500ms odblokowujemy scrollowanie
            setTimeout(() => {
                isScrolling = false;
            }, scrollDelay);
        }

        function loadLazyImages() {
            document.querySelectorAll(".lazy-image").forEach(img => {
                if (!img.src) {
                    img.src = img.getAttribute('data-src');
                    img.classList.add("visible");
                }
            });
        }

        function handleInteraction() {
            if (!firstInteraction) {
                firstInteraction = true;
                loadLazyImages();
            }
        }

        function handleScroll(event) {
            if (isScrolling) return; // Jeśli trwa przewijanie, ignorujemy kolejne akcje
            isScrolling = true; // Blokujemy kolejne przewinięcia

            handleInteraction();

            let delta = event.deltaY;
            const currentTime = Date.now();

            // Po pierwszej interakcji, tylko zdjęcie z 2017
            if (!firstInteraction) {
                firstInteraction = true;
                // Tylko zdjęcie z 2017 jest widoczne
                showItem(0); // Pokaż tylko 2017
                isScrolling = false; // Zablokuj przewijanie
                return;
            }

            // Dodanie opóźnienia między 2017 a 2018
            if (index === 0 && delta > 0 && currentTime - lastScrollTime < yearDelay) {
                isScrolling = false;
                return; // Opóźnienie między 2017 a 2018
            }

            // Zapisz czas przewinięcia
            lastScrollTime = currentTime;

            if (Math.abs(delta) >= scrollThreshold) {
                if (delta > 0 && index < items.length - 1) {
                    index++;
                } else if (delta < 0 && index > 0) {
                    index--;
                }
                showItem(index);
            } else {
                isScrolling = false; // Jeśli próg nie został przekroczony, odblokuj natychmiast
            }
        }


        document.addEventListener("wheel", handleScroll);

        // Obsługa dotyku na telefonach
        let touchStartY = 0;
        document.addEventListener("touchstart", (event) => {
            touchStartY = event.touches[0].clientY;
        });

        document.addEventListener("touchmove", (event) => {
            if (isScrolling) return;
            isScrolling = true;

            let touchEndY = event.touches[0].clientY;
            let delta = touchStartY - touchEndY;

            if (Math.abs(delta) >= scrollThreshold) {
                handleInteraction();

                if (delta > 40 && index < items.length - 1) {
                    index++;
                } else if (delta < -40 && index > 0) {
                    index--;
                }
                showItem(index);
            } else {
                isScrolling = false;
            }
        });

        showItem(index);




    </script>
</body>

</html>
